# Invoice OCR Project

created by Anna Dudek @Anna-portfolio

## Overview

A modular pipeline for preprocessing scanned documents and classifying their type (invoice, contract, ID card, etc.).  
The current version uses a PyTorch model for testing the end-to-end workflow.  
<br>

## Project Structure

Invoice_OCR/
│
├── data/
│ ├── raw/ # Raw input images
│ └── processed/ # Images after preprocessing
│
├── models/
│ └── document_classifier.pt # Dummy model (auto-generated)
│
├── src/
│ ├── preprocessing/ # Image preprocessing modules
│ └── classification/ # Model + inference pipeline
│
├── notebooks/ # Experiments & prototypes
├── configs/ # YAML configuration files
└── tests/ # Unit tests


<br>

## Preprocessing Pipeline

The preprocessing module applies several operations to normalize image quality before classification:

* **Denoising** – removes image noise  
* **Gamma correction** – normalizes exposure  
* **CLAHE** – boosts local contrast  
* **Linear brightening** – additional brightness adjustment  
* **Deskew (Hough Transform)** – fixes rotation/skew  
* **Orientation normalization** – rotates documents by ±90° or 180° if required  

These steps produce a high-quality, normalized image suitable for classification or OCR.  
<br>

## Usage

```python
def run():
    # 1. Paths
    raw_image = "data/raw/invoice_original.png"
    preprocessed_image = "data/processed/invoice_preprocessed.png"
    model_path = "models/document_classifier.pt"

    os.makedirs(os.path.dirname(preprocessed_image), exist_ok=True)

    # 1. Preprocessing
    processed = preprocess_invoice_pipeline(
        image_path=raw_image,
        output_path=preprocessed_image
    )

    # 2. Classification
    result = classify_document(
        image_path=preprocessed_image,
        model_path=model_path
    )

    # 3. Result
    print("Prediction result:", result)
